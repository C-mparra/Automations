Set-ExecutionPolicy RemoteSigned -Scope Process -Force
Import-Module PSWindowsUpdate -Force
Get-WindowsUpdate -MicrosoftUpdate -IsInstalled:$false


Get-ChildItem -Path "D:\" -Recurse -Filter "SentinelOne-win32_windows_legacy_v2_1_0_86.exe" -ErrorAction SilentlyContinue

Get-Process -Name powershell | ForEach-Object { $_.Kill() }

Expand-Archive -Path "C:\Temp\FirefoxPortable.zip" -DestinationPath "C:\Temp\Firefox" -Force

# Construct the uninstall command for MsiExec.exe with the GUID from the registry
$uninstallCommand = "MsiExec.exe /X{C8511AEB-814C-4D6F-AA45-44035EAD563B} /quiet /norestart"

# Execute the uninstall command
Write-Host "Uninstalling Advanced IP Scanner..."
Start-Process -FilePath "MsiExec.exe" -ArgumentList "/X{C8511AEB-814C-4D6F-AA45-44035EAD563B} /quiet /norestart" -NoNewWindow -Wait



# PowerShell script to uninstall SeaMonkey Portable
# Define paths
$seaMonkeyFolder = "C:\Temp\RMM\SeaMonkey\SeaMonkeyPortable"
$startMenuFolder = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs"
$shortcutName = "SeaMonkey Portable.lnk"
$shortcutPath = [System.IO.Path]::Combine($startMenuFolder, $shortcutName)

# Remove SeaMonkey Portable folder
If (Test-Path $seaMonkeyFolder) {
    Write-Host "Removing SeaMonkey Portable folder..."
    Remove-Item -Path $seaMonkeyFolder -Recurse -Force
    Write-Host "SeaMonkey Portable folder removed."
} Else {
    Write-Host "SeaMonkey Portable folder not found."
}

# Remove Start Menu shortcut
If (Test-Path $shortcutPath) {
    Write-Host "Removing Start Menu shortcut..."
    Remove-Item -Path $shortcutPath -Force
    Write-Host "Start Menu shortcut removed."
} Else {
    Write-Host "No Start Menu shortcut found."
}

Write-Host "SeaMonkey Portable uninstallation completed."
